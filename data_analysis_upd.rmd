---
title: "Разведанализ данных"
output: 
  html_document:
    df_print: paged

---

В нашем исследовании мы используем усредненные данные по **50 штатам США с 2010 по 2019 год.**

Чтобы изучить экономические условия штата, мы включили такие характеристики как количество совершенных насильственных преступлений, уровень бедности и безработицы, а также доход и реальный ВВП населения.

Данные были собраны с разных ресурсов, так что требовали некоторых преобразований для дальнейшего анализа.

Предварительный просмотр данных:

```{r message = FALSE, warning=FALSE, echo = F, comment = "", comment = ""}
library(readr)
id = "1m4iUqrvzF0AA-P4l0iU4PYoD7LiyjVt8"
crime = read.csv(sprintf("https://drive.google.com/uc?id=%s&export=download", id))

library(dplyr)
crime = crime %>% select(-X)

library(DT)
datatable(crime)

library(knitr)
```


# Рассмотрим обощающие данные по всем переменным:

## Переменная State

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
summary(crime$State)
```

Текстовая переменная, обозначающая название штата. 

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
unique(crime$State)
```

Имеет 50 уникальных значений.


## Переменная Vcrime

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
summary(crime$Vcrime)
```

Числовая переменная, указывающий количество совершенных насильственных преступлений (violent crimes) на 100 тысяч населения.

Значения колеблются в диапазоне от 122 до 703, где среднее (363) и медианное (337) близки друг к другу.

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
library(ggplot2)
ggplot() +
  geom_histogram(data = crime, mapping = aes(x = Vcrime), fill="lightcoral", col="red") +
  ggtitle("Распределение количества совершенных насильственных \nпреступлений") + 
  xlab("Число преступлений") + 
 	ylab("Плотность") + 
  theme(plot.title = element_text(lineheight = .8),
    axis.text = element_text(colour = 'black'),
    axis.text.x = element_text(size = 8, hjust = 1)) 
```

На графике видно, что количество регистрируемых наблюдений в целом находится на достаточно высоком уровне, что еще раз подтверждает выводы СМИ о существующей проблеме с насильственными преступлениями на территории Соединенных Штатов Америки. Статистический службы также зафиксировали и несколько экстремально высоких значений за все время наблюдения (более 600 преступлений). Подобные выбросы можно объяснить снижением затрат на финансирование правоохранительных органов, усилением расслоения общества, экономическими шоками. Следует заметить, что это могло произойти и вследствие ошибок при фиксации и регистрации насильственных преступлений.


## Переменная PR

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
summary(crime$PR)
```

Poverty rate - числовая переменная, означающая уровень бедности в долях, то есть от 0 до 1.

В нашем случае минимальное значение 0.0818, а максимальное 0.2173

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
ggplot() +
  geom_histogram(data = crime, mapping = aes(x = PR), fill = 'paleturquoise', 
                 col = 'cornflowerblue') +
  ggtitle("Распределение уровня бедности населения") + 
  xlab("Уровень бедности") + 
 	ylab("Плотность") + 
  theme(plot.title = element_text(lineheight = .8),
    axis.text = element_text(colour = 'black'),
    axis.text.x = element_text(size = 8, hjust = 1)) 
```

В среднем за весь период наблюдений почти все штаты показывают неплохие - относительно мировых - результаты. Тем не менее, на графике мы можем наблюдать штаты, которые за десять лет наблюдений все так же имеют достаточно высокую (близко к 0,2 и выше) долю населения, находящегося за чертой бедности. Это может объясняться локальными экономическими, географическими и климатическими особенностями, которые мешают развитию штата. 


## Переменная UR

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
summary(crime$UR)
```

Unemployment rate - уровень безработицы в штатах в долях. Значения колеблются от 2,9% до 8,3%

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
ggplot() +
  geom_histogram(data = crime, mapping = aes(x = UR*100), fill="hotpink", col="magenta") +
  geom_vline(aes(xintercept = mean(crime$UR*100)), linetype="dashed", color="blue", size=1) +
  geom_vline(aes(xintercept = median(crime$UR*100)), linetype="dotdash", color="red", size=1) +
  ggtitle("Распределение уровня безработицы среди населения") + 
  xlab("Уровень безработицы (%)") + 
 	ylab("Плотность") + 
  theme(plot.title = element_text(lineheight = .8),
    axis.text = element_text(colour = 'black'),
    axis.text.x = element_text(size = 8, hjust = 1)) 
```

На графике видно, что среднее значение и медиана безработицы находятся в пределах 6 %, как было в таблице. 

Также видно, что в среднем в Соединенных Штатах Америки сохраняется достаточно низкий уровень безработицы, что может указывать на эффективность работы служб занятости и наличии свободных рабочих мест. Выбросы на графике можно объяснить локальными коллапсами или, например, длительным восстановлением после кризиса 2007-2009 годов.


## Переменная PIPC 

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
summary(crime$PIPC)
```

Personal income per capita - числовое значение, выражающее доход на душу населения в долларах.

Максимальное значение (67553) почти в два раза больше минимального (35163), хотя среднее и медианное значения - чуть больше 45000. Получается, что значений, близких к максимальному, довольно мало.

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
ggplot() +
  geom_histogram(data = crime, mapping = aes(x = PIPC), fill="skyblue", col="blue") +
  geom_vline(aes(xintercept = mean(crime$PIPC)), linetype="dashed", color="#800080", size=1) +
  geom_vline(aes(xintercept = median(crime$PIPC)), linetype="dotdash", color="white", size=1) +
  ggtitle("Распределение дохода населения") + 
  xlab("Уровень дохода") + 
 	ylab("Плотность") + 
  theme(plot.title = element_text(lineheight = .8),
    axis.text = element_text(colour = 'black'),
    axis.text.x = element_text(size = 8, hjust = 1)) 
```

Выбросы на графике можно объяснить спецификой данного показателя: он фиксирует все доходы человека (зарплата, доходы от аренды, дивиденды, трансферты и другие виды). Это приводит к следующей ситуации: в маленьких штатах показатель PIPC может быть либо слишком высоким, либо слишком низким из-за небывалой урожайности (особенно актуально для аграрно-зависимых штатов), природной катастрофы или крупного экономического проекта. В то же время дополнительное население (например, студенты колледжей из других штатов) может занижать показатели PIPC.


## Переменная RGDP

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
summary(crime$RGDP)
```

Real GDP - числовое значение реального ВВП штата. За 10 лет он колеблется от 29180 до 2335826.

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
ggplot() +
  geom_histogram(data = crime, mapping = aes(x = RGDP), fill="palegreen", col="limegreen") +
  ggtitle("Распределение реального ВВП") + 
  xlab("Значение реального ВВП") + 
 	ylab("Плотность") + 
  theme(plot.title = element_text(lineheight = .8),
    axis.text = element_text(colour = 'black'),
    axis.text.x = element_text(size = 8, hjust = 1)) 
```

По графику видно, что некоторые значения сильно выбиваются по значению ВВП в большую сторону. 

Чтобы понять, как именно выглядит выброс, отсортируем данные по уровню ВВП в штате:

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
datatable(crime %>% arrange(desc(RGDP)) %>% select(State, RGDP))
```

Таким образом, мы видим, что штат Калифорния отличается от других штатов тем, что средний реальный ВВП с 2010 по 2019 год был выше 2000000, а у остальных штатов значительно ниже. Нельзя назвать это выбросом данных, так как все значения принадлежат одному штату за все года, то есть это реально возможные значения.

Нетрудно объяснить подобное отклонение реального ВВП: Калифорния - крупнейшая экономика в рамках Соединенных Штатов Америки, пятая по показателям ВВП даже среди стран. Одними из драйверов подобного успеха являются численность населения и диверсификация экономики (финансовый сектор и недвижимость, информационная отрасль, производственный сектор вносят наибольший вклад).


# Общий вывод

Нам удалось собрать датасет с усредненными данными за обширный период времени, на основе которого мы сможем проверить нашу гипотезу о наличии зависимости между экономическими условиями штата и количеством насильственных преступлений в нем. В рамках разведанализа нам удалось провести чистку данных и убедиться в правильности выбора переменных в рамках нашего исследования. 