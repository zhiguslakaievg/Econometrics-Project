---
title: "Регрессионный анализ данных"
output:
  html_document:
  pdf_document: default
---

Повторная загрузка данных:

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
library(readr)
id = "1m4iUqrvzF0AA-P4l0iU4PYoD7LiyjVt8"
crime = read.csv(sprintf("https://drive.google.com/uc?id=%s&export=download", id))

library(dplyr)
crime = crime %>% select(-X)

#install.packages("lmtest")
library(lmtest)
library(stats)
library(sandwich)
```

В нашей модели мы приняли решение прологарифмировать переменные PIPC и RGDP из-за наличия выбросов и большого разброса значений. Также, из-за наличия гетероскедастичности в переменной RGDP мы рассчитали робастные оценки. 

Подробный разбор причины и анализ переменных можно увидеть в разведанализе данных.

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
model = lm(Vcrime ~ PR + UR + log(PIPC) + log(RGDP), data = crime)
coeftest(model, df = Inf, vcov = vcovHC, type = 'HC0')
```

Согласно нашей модели, на уровне значимости 5% значимой является только переменная, содержащая информацию об уровне бедности.

Далее мы провели несколько тестов Вальда для проверки гипотезы: 

```{r message = FALSE, warning=FALSE, echo = F, comment = ""}
reg0 = lm(Vcrime ~ PR + UR + log(PIPC) + log(RGDP), data = crime)
reg1 = lm(Vcrime ~ UR + log(PIPC) + log(RGDP), data = crime)
reg2 = lm(Vcrime ~ PR + log(PIPC) + log(RGDP), data = crime)
reg3 = lm(Vcrime ~ PR + UR + log(RGDP), data = crime)
reg4 = lm(Vcrime ~ PR + UR + log(PIPC), data = crime)
lmtest::waldtest(reg1, reg0, test = "Chisq", vcov = vcovHC(reg0, type = "HC0"))
lmtest::waldtest(reg2, reg0, test = "Chisq", vcov = vcovHC(reg0, type = "HC0"))
lmtest::waldtest(reg3, reg0, test = "Chisq", vcov = vcovHC(reg0, type = "HC0"))
lmtest::waldtest(reg4, reg0, test = "Chisq", vcov = vcovHC(reg0, type = "HC0"))
```

Они подтвердили наши результаты: нулевая гипотеза отвергается только для переменной PR.







